"use strict";module.exports=class{constructor(){}static exec(b="",c){var d=b.replace("\n","").replace("\r","").replace("<!DOCTYPE html>",""),e=this.parseHtml(this.clean_line(d));c(e)}static parseHtml(b="",c=0){b=this.clean_line(b);let e=[];if(0>c||0>=b.length)return null;for(;"<"!=b[0]&&0<b.length;)b=b.slice(1);for(;1===b.indexOf("<!--");)b=b.slice(b.indexOf("-->"));let f=this.getBaliseInfo(b);if(-1!=f.index){let g=f.index,h=0;if("script"!=f.balise.name){if(!1==f.balise.is_end){h=this.getPosEndOfBalise(b,f),g=h+3+f.balise.name.length;let j=b.slice(f.index+1,h);-1==this.getBaliseInfo(j).index&&(f.balise.value=j),f.balise.next=this.parseHtml(j,c+1),e.push(f.balise);let k=this.parseHtml(b.slice(g),c+1);if(k)for(let l=0;l<k.length;l++)e.push(k[l])}else{g=f.balise.pos_end,e.push(f.balise);let j=this.parseHtml(b.slice(f.balise.pos_end),c+1);if(j)for(let k=0;k<j.length;k++)e.push(j[k])}return e}return null}}static getPosEndOfBalise(b="",c){let d=c.balise.name.length+1,e=b.slice(d),f=0;for(;0<e.length;){let g=e.indexOf("</"+c.balise.name),h=e.indexOf("<"+c.balise.name);if(h<g&&-1!==h)f--,d+=h+1+c.balise.name.length;else{if(f++,1==f)return g+d;d+=3+c.balise.name.length+g}e=b.slice(d)}}static getBaliseInfo(b=""){let c=b.indexOf("<"),d=b.indexOf(" "),e=b.indexOf(">"),f=b.indexOf("/>"),g=!0;(f>e||-1===f)&&(f=e,g=!1),(f<d||-1===d)&&(d=f);let h=b.slice(c+1,d);-1!==["link"].indexOf(h)&&(g=!0);let j=b.slice(c+1+h.length,f).trim(),k=null;""!=j&&(k=j.split(" "));let l={name:h,content:k,is_end:g};return!0==l.is_end&&(l.pos_end=f),{index:e,balise:l}}static clean_line(b){if(!b)return b;for(;-1!==b.indexOf("  ");)b=b.replace("  "," ");return b.replace("\t","").replace("\r","").trim()}};